<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <!-- æ·±è‰²/æ·ºè‰²æ¨¡å¼ï¼ˆå…§è¯è…³æœ¬+æ¨£å¼ï¼Œé¿å…é–ƒçˆï¼‰ -->
    <script>try{var s=JSON.parse(localStorage.getItem('bentoai_settings')||'{}');if(s.darkMode){document.documentElement.classList.add('dark-mode')}else{document.documentElement.classList.remove('dark-mode')}}catch(e){document.documentElement.classList.remove('dark-mode')}</script>
    <style>html:not(.dark-mode),html:not(.dark-mode) body{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)!important}html:not(.dark-mode) .bottom-nav{background:white!important}html:not(.dark-mode) .nav-item{color:#999!important}html.dark-mode,html.dark-mode body{background:linear-gradient(135deg,#1a1a2e 0%,#16213e 100%)!important}html.dark-mode .bottom-nav{background:#1a1a2e!important;border-top:1px solid #2a2a3e}html.dark-mode .nav-item{color:#888!important}html.dark-mode .container,html.dark-mode .header,html.dark-mode .section,html.dark-mode .form-section,html.dark-mode .form-group,html.dark-mode .settings-section,html.dark-mode .settings-item,html.dark-mode .user-card,html.dark-mode .user-header,html.dark-mode .user-info,html.dark-mode .profile-item,html.dark-mode .profile-grid,html.dark-mode .profile-panel,html.dark-mode .option-card,html.dark-mode .feature-card,html.dark-mode .stat-card,html.dark-mode .summary-item,html.dark-mode .nutrition-item,html.dark-mode .nutrition-card,html.dark-mode .chart-container,html.dark-mode .chart-section,html.dark-mode .insight-card,html.dark-mode .tips-card,html.dark-mode .recent-card,html.dark-mode .card,html.dark-mode .chat-container,html.dark-mode .chat-header,html.dark-mode .chat-messages,html.dark-mode .chat-input-area,html.dark-mode .quick-questions,html.dark-mode .welcome-message,html.dark-mode .edit-form,html.dark-mode .stats-grid,html.dark-mode .loading,html.dark-mode .step,html.dark-mode .total-item,html.dark-mode .input-wrapper,html.dark-mode .options-grid,html.dark-mode .multi-option,html.dark-mode .tech-item,html.dark-mode .empty-state,html.dark-mode .filter-btn,html.dark-mode .time-selector,html.dark-mode .controls,html.dark-mode .record-card,html.dark-mode .meal-section,html.dark-mode .food-item,html.dark-mode .modal-content,html.dark-mode .upload-area,html.dark-mode .result-card,html.dark-mode .analysis-card{background:#1e1e2e!important;color:#e0e0e0!important}html.dark-mode input,html.dark-mode select,html.dark-mode textarea{background:#2a2a3e!important;color:#e0e0e0!important;border-color:#3a3a4e!important}html.dark-mode .btn-secondary{background:#3a3a4e!important;color:#e0e0e0!important}</style>
    <meta charset="UTF-8">
    <script src="/js/dark-mode.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®‰è£å¥åº·æ•¸æ“šåŠ©ç† - åŠ å…¥ä¸»ç•«é¢</title>
    <!-- PWA æ”¯æ´ -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="å¥åº·åŠ©ç†">
    <link rel="apple-touch-icon" href="logo.png">
    <link rel="icon" href="logo.png" type="image/png">

    <!-- å…±ç”¨å·¥å…·å‡½æ•¸ -->
    <script src="/js/utils.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            padding: 30px 0;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 16px;
        }

        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            text-decoration: none;
        }

        .back-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .card h2 {
            color: #333;
            font-size: 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card h2 .icon {
            font-size: 28px;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .feature {
            background: #f8f9ff;
            padding: 20px 15px;
            border-radius: 12px;
            text-align: center;
        }

        .feature .emoji {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .feature h4 {
            color: #333;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .feature p {
            color: #666;
            font-size: 12px;
        }

        .platform-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .platform-tab {
            flex: 1;
            padding: 15px;
            border: 2px solid #eee;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
        }

        .platform-tab:hover {
            border-color: #667eea;
        }

        .platform-tab.active {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .platform-tab .icon {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .platform-tab .name {
            font-size: 14px;
            font-weight: 600;
        }

        .instructions {
            display: none;
        }

        .instructions.active {
            display: block;
        }

        .step {
            display: flex;
            gap: 15px;
            padding: 20px 0;
            border-bottom: 1px solid #eee;
        }

        .step:last-child {
            border-bottom: none;
        }

        .step-number {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .step-content h4 {
            color: #333;
            font-size: 16px;
            margin-bottom: 8px;
        }

        .step-content p {
            color: #666;
            font-size: 14px;
            line-height: 1.6;
        }

        .step-content .highlight {
            background: #f0f0f0;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 13px;
        }

        .step-image {
            margin-top: 15px;
            background: #f5f5f5;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .step-image .placeholder {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .step-image p {
            color: #888;
            font-size: 12px;
        }

        .install-btn {
            display: none;
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }

        .install-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .install-btn.show {
            display: block;
        }

        .already-installed {
            display: none;
            text-align: center;
            padding: 30px;
            background: #e8f5e9;
            border-radius: 12px;
            margin-top: 20px;
        }

        .already-installed.show {
            display: block;
        }

        .already-installed .icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .already-installed h3 {
            color: #2e7d32;
            margin-bottom: 10px;
        }

        .already-installed p {
            color: #558b2f;
        }

        .tips {
            background: #fff3cd;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .tips h4 {
            color: #856404;
            font-size: 14px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tips ul {
            color: #856404;
            font-size: 13px;
            padding-left: 20px;
        }

        .tips li {
            margin-bottom: 5px;
        }

        /* æ·±è‰²æ¨¡å¼ */
        html.dark-mode {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }

        html.dark-mode .card {
            background: #1e1e1e;
        }

        html.dark-mode .card h2 {
            color: #e0e0e0;
        }

        html.dark-mode .feature {
            background: #2a2a2a;
        }

        html.dark-mode .feature h4 {
            color: #e0e0e0;
        }

        html.dark-mode .feature p {
            color: #aaa;
        }

        html.dark-mode .platform-tab {
            background: #2a2a2a;
            border-color: #444;
            color: #e0e0e0;
        }

        html.dark-mode .platform-tab:hover {
            border-color: #667eea;
        }

        html.dark-mode .platform-tab.active {
            color: white;
        }

        html.dark-mode .step {
            border-bottom-color: #444;
        }

        html.dark-mode .step-content h4 {
            color: #e0e0e0;
        }

        html.dark-mode .step-content p {
            color: #aaa;
        }

        html.dark-mode .step-content .highlight {
            background: #333;
            color: #e0e0e0;
        }

        html.dark-mode .step-image {
            background: #2a2a2a;
        }

        html.dark-mode .tips {
            background: #3d3520;
        }

        html.dark-mode .tips h4,
        html.dark-mode .tips ul {
            color: #d4a84b;
        }

        html.dark-mode .already-installed {
            background: #1b3d1b;
        }

        html.dark-mode .already-installed h3 {
            color: #81c784;
        }

        html.dark-mode .already-installed p {
            color: #a5d6a7;
        }

        @media (max-width: 480px) {
            .features {
                grid-template-columns: 1fr;
            }

            .platform-tabs {
                flex-direction: column;
            }

            .back-btn {
                position: static;
                display: inline-block;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="welcome.html" class="back-btn">â† è¿”å›</a>

        <div class="header">
            <h1>ğŸ“² å®‰è£å¥åº·æ•¸æ“šåŠ©ç†</h1>
            <p>å°‡å¥åº·æ•¸æ“šåŠ©ç†åŠ å…¥ä¸»ç•«é¢ï¼Œç²å¾—æ›´å¥½çš„ä½¿ç”¨é«”é©—</p>
        </div>

        <!-- PWA åŠŸèƒ½ä»‹ç´¹ -->
        <div class="card">
            <h2><span class="icon">âœ¨</span> å®‰è£å¾Œå¯äº«æœ‰</h2>
            <div class="features">
                <div class="feature">
                    <div class="emoji">ğŸš€</div>
                    <h4>å¿«é€Ÿå•Ÿå‹•</h4>
                    <p>å¾ä¸»ç•«é¢ç›´æ¥é–‹å•Ÿ</p>
                </div>
                <div class="feature">
                    <div class="emoji">ğŸ“±</div>
                    <h4>å…¨è¢å¹•é«”é©—</h4>
                    <p>å¦‚åŒåŸç”Ÿ App</p>
                </div>
                <div class="feature">
                    <div class="emoji">ğŸ“´</div>
                    <h4>é›¢ç·šç€è¦½</h4>
                    <p>éƒ¨åˆ†åŠŸèƒ½å¯é›¢ç·šä½¿ç”¨</p>
                </div>
                <div class="feature">
                    <div class="emoji">ğŸ””</div>
                    <h4>æ¨æ’­é€šçŸ¥</h4>
                    <p>æ¥æ”¶ç”¨é¤æé†’</p>
                </div>
            </div>

            <!-- å·²å®‰è£æç¤º -->
            <div class="already-installed" id="alreadyInstalled">
                <div class="icon">âœ…</div>
                <h3>å·²å®‰è£å¥åº·æ•¸æ“šåŠ©ç†</h3>
                <p>æ‚¨å·²ç¶“å°‡å¥åº·æ•¸æ“šåŠ©ç†åŠ å…¥ä¸»ç•«é¢ï¼</p>
            </div>

            <!-- å¿«é€Ÿå®‰è£æŒ‰éˆ• (åƒ…æ”¯æ´çš„ç€è¦½å™¨é¡¯ç¤º) -->
            <button class="install-btn" id="installBtn" onclick="installPWA()">
                ç«‹å³å®‰è£å¥åº·æ•¸æ“šåŠ©ç†
            </button>
        </div>

        <!-- å®‰è£æ­¥é©Ÿ -->
        <div class="card">
            <h2><span class="icon">ğŸ“–</span> å®‰è£æ•™å­¸</h2>

            <!-- å¹³å°é¸æ“‡ -->
            <div class="platform-tabs">
                <div class="platform-tab active" data-platform="ios" onclick="showPlatform('ios')">
                    <div class="icon">ğŸ</div>
                    <div class="name">iPhone / iPad</div>
                </div>
                <div class="platform-tab" data-platform="android" onclick="showPlatform('android')">
                    <div class="icon">ğŸ¤–</div>
                    <div class="name">Android</div>
                </div>
                <div class="platform-tab" data-platform="desktop" onclick="showPlatform('desktop')">
                    <div class="icon">ğŸ’»</div>
                    <div class="name">é›»è…¦ç‰ˆ</div>
                </div>
            </div>

            <!-- iOS èªªæ˜ -->
            <div class="instructions active" id="ios-instructions">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h4>ä½¿ç”¨ Safari é–‹å•Ÿ</h4>
                        <p>è«‹ç¢ºä¿æ‚¨æ˜¯ä½¿ç”¨ <strong>Safari ç€è¦½å™¨</strong>é–‹å•Ÿæ­¤ç¶²ç«™ã€‚å…¶ä»–ç€è¦½å™¨ï¼ˆå¦‚ Chromeï¼‰ç„¡æ³•åœ¨ iOS ä¸Šå®‰è£ PWAã€‚</p>
                        <div class="step-image">
                            <div class="placeholder">ğŸ§­</div>
                            <p>Safari ç€è¦½å™¨åœ–ç¤º</p>
                        </div>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h4>é»æ“Šåˆ†äº«æŒ‰éˆ•</h4>
                        <p>åœ¨ Safari åº•éƒ¨å·¥å…·åˆ—ï¼Œé»æ“Šä¸­é–“çš„ <span class="highlight">åˆ†äº«</span> æŒ‰éˆ•ï¼ˆæ–¹å½¢åŠ ä¸Šç®­é ­çš„åœ–ç¤ºï¼‰ã€‚</p>
                        <div class="step-image">
                            <div class="placeholder">â¬†ï¸</div>
                            <p>åˆ†äº«æŒ‰éˆ•ä½æ–¼åº•éƒ¨ä¸­å¤®</p>
                        </div>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h4>é¸æ“‡ã€ŒåŠ å…¥ä¸»ç•«é¢ã€</h4>
                        <p>åœ¨åˆ†äº«é¸å–®ä¸­å‘ä¸‹æ»‘å‹•ï¼Œæ‰¾åˆ°ä¸¦é»æ“Š <span class="highlight">åŠ å…¥ä¸»ç•«é¢</span> é¸é …ã€‚</p>
                        <div class="step-image">
                            <div class="placeholder">â•</div>
                            <p>åŠ å…¥ä¸»ç•«é¢é¸é …</p>
                        </div>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h4>ç¢ºèªæ–°å¢</h4>
                        <p>ç¢ºèªåç¨±ç‚ºã€Œå¥åº·åŠ©ç†ã€ï¼Œç„¶å¾Œé»æ“Šå³ä¸Šè§’çš„ <span class="highlight">æ–°å¢</span> æŒ‰éˆ•å³å¯å®Œæˆï¼</p>
                        <div class="step-image">
                            <div class="placeholder">âœ…</div>
                            <p>é»æ“Šã€Œæ–°å¢ã€å®Œæˆå®‰è£</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Android èªªæ˜ -->
            <div class="instructions" id="android-instructions">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h4>ä½¿ç”¨ Chrome é–‹å•Ÿ</h4>
                        <p>è«‹ä½¿ç”¨ <strong>Chrome ç€è¦½å™¨</strong>é–‹å•Ÿæ­¤ç¶²ç«™ä»¥ç²å¾—æœ€ä½³é«”é©—ã€‚</p>
                        <div class="step-image">
                            <div class="placeholder">ğŸŒ</div>
                            <p>Chrome ç€è¦½å™¨åœ–ç¤º</p>
                        </div>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h4>é»æ“Šé¸å–®æŒ‰éˆ•</h4>
                        <p>é»æ“Š Chrome å³ä¸Šè§’çš„ <span class="highlight">â‹®</span> é¸å–®æŒ‰éˆ•ï¼ˆä¸‰å€‹é»ï¼‰ã€‚</p>
                        <div class="step-image">
                            <div class="placeholder">â‹®</div>
                            <p>é¸å–®æŒ‰éˆ•ä½æ–¼å³ä¸Šè§’</p>
                        </div>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h4>é¸æ“‡ã€Œå®‰è£æ‡‰ç”¨ç¨‹å¼ã€æˆ–ã€ŒåŠ åˆ°ä¸»ç•«é¢ã€</h4>
                        <p>åœ¨é¸å–®ä¸­æ‰¾åˆ° <span class="highlight">å®‰è£æ‡‰ç”¨ç¨‹å¼</span> æˆ– <span class="highlight">åŠ åˆ°ä¸»ç•«é¢</span> é¸é …ä¸¦é»æ“Šã€‚</p>
                        <div class="step-image">
                            <div class="placeholder">ğŸ“²</div>
                            <p>å®‰è£æ‡‰ç”¨ç¨‹å¼é¸é …</p>
                        </div>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h4>ç¢ºèªå®‰è£</h4>
                        <p>åœ¨å½ˆå‡ºçš„å°è©±æ¡†ä¸­é»æ“Š <span class="highlight">å®‰è£</span> å³å¯å®Œæˆï¼App åœ–ç¤ºå°‡å‡ºç¾åœ¨æ‚¨çš„ä¸»ç•«é¢ä¸Šã€‚</p>
                        <div class="step-image">
                            <div class="placeholder">âœ…</div>
                            <p>é»æ“Šã€Œå®‰è£ã€å®Œæˆ</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- é›»è…¦ç‰ˆèªªæ˜ -->
            <div class="instructions" id="desktop-instructions">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h4>ä½¿ç”¨ Chrome æˆ– Edge é–‹å•Ÿ</h4>
                        <p>è«‹ä½¿ç”¨ <strong>Chrome</strong> æˆ– <strong>Microsoft Edge</strong> ç€è¦½å™¨é–‹å•Ÿæ­¤ç¶²ç«™ã€‚</p>
                        <div class="step-image">
                            <div class="placeholder">ğŸŒ</div>
                            <p>Chrome æˆ– Edge ç€è¦½å™¨</p>
                        </div>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h4>å°‹æ‰¾å®‰è£åœ–ç¤º</h4>
                        <p>åœ¨ç¶²å€åˆ—å³å´ï¼Œæ‚¨æœƒçœ‹åˆ°ä¸€å€‹ <span class="highlight">å®‰è£</span> åœ–ç¤ºï¼ˆé›»è…¦åŠ ä¸Šç®­é ­ï¼‰ï¼Œæˆ–è€…é»æ“Šé¸å–®ä¸­çš„ã€Œå®‰è£å¥åº·æ•¸æ“šåŠ©ç†ã€ã€‚</p>
                        <div class="step-image">
                            <div class="placeholder">ğŸ’»</div>
                            <p>å®‰è£åœ–ç¤ºåœ¨ç¶²å€åˆ—å³å´</p>
                        </div>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h4>ç¢ºèªå®‰è£</h4>
                        <p>é»æ“Šå®‰è£æŒ‰éˆ•å¾Œï¼Œåœ¨å½ˆå‡ºçš„å°è©±æ¡†ä¸­ç¢ºèª <span class="highlight">å®‰è£</span>ã€‚</p>
                        <div class="step-image">
                            <div class="placeholder">âœ…</div>
                            <p>ç¢ºèªå®‰è£å°è©±æ¡†</p>
                        </div>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h4>å¾æ¡Œé¢æˆ–é–‹å§‹é¸å–®é–‹å•Ÿ</h4>
                        <p>å®‰è£å®Œæˆå¾Œï¼Œæ‚¨å¯ä»¥å¾æ¡Œé¢æ·å¾‘æˆ–é–‹å§‹é¸å–®ä¸­æ‰¾åˆ°ä¸¦é–‹å•Ÿå¥åº·æ•¸æ“šåŠ©ç†ï¼</p>
                        <div class="step-image">
                            <div class="placeholder">ğŸ‰</div>
                            <p>å®‰è£å®Œæˆï¼</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tips">
                <h4>ğŸ’¡ å°æç¤º</h4>
                <ul>
                    <li>å®‰è£å¾Œå¾ä¸»ç•«é¢é–‹å•Ÿï¼Œå¯äº«æœ‰å…¨è¢å¹•é«”é©—</li>
                    <li>PWA æœƒè‡ªå‹•æ›´æ–°ï¼Œç„¡éœ€æ‰‹å‹•æ›´æ–°</li>
                    <li>å¦‚éœ€ç§»é™¤ï¼Œé•·æŒ‰åœ–ç¤ºé¸æ“‡åˆªé™¤å³å¯</li>
                    <li>å»ºè­°é–‹å•Ÿé€šçŸ¥æ¬Šé™ï¼Œæ¥æ”¶ç”¨é¤æé†’</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // åµæ¸¬è£ç½®é¡å‹ä¸¦è‡ªå‹•é¸æ“‡å°æ‡‰èªªæ˜
        function detectPlatform() {
            const ua = navigator.userAgent.toLowerCase();

            if (/iphone|ipad|ipod/.test(ua)) {
                return 'ios';
            } else if (/android/.test(ua)) {
                return 'android';
            } else {
                return 'desktop';
            }
        }

        // åˆ‡æ›å¹³å°èªªæ˜
        function showPlatform(platform) {
            // æ›´æ–° tab ç‹€æ…‹
            document.querySelectorAll('.platform-tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.dataset.platform === platform) {
                    tab.classList.add('active');
                }
            });

            // æ›´æ–°èªªæ˜å…§å®¹
            document.querySelectorAll('.instructions').forEach(inst => {
                inst.classList.remove('active');
            });
            document.getElementById(platform + '-instructions').classList.add('active');
        }

        // PWA å®‰è£æç¤º
        let deferredPrompt = null;

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            // é¡¯ç¤ºå®‰è£æŒ‰éˆ•
            document.getElementById('installBtn').classList.add('show');
        });

        // é»æ“Šå®‰è£æŒ‰éˆ•
        async function installPWA() {
            if (!deferredPrompt) {
                alert('è«‹ä½¿ç”¨ç€è¦½å™¨é¸å–®ä¸­çš„ã€Œå®‰è£ã€æˆ–ã€ŒåŠ å…¥ä¸»ç•«é¢ã€åŠŸèƒ½');
                return;
            }

            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;

            if (outcome === 'accepted') {
                console.log('PWA å®‰è£æˆåŠŸ');
                document.getElementById('installBtn').classList.remove('show');
                document.getElementById('alreadyInstalled').classList.add('show');
            }

            deferredPrompt = null;
        }

        // æª¢æŸ¥æ˜¯å¦å·²å®‰è£
        function checkInstalled() {
            if (window.matchMedia('(display-mode: standalone)').matches) {
                document.getElementById('alreadyInstalled').classList.add('show');
                document.getElementById('installBtn').classList.remove('show');
                return true;
            }
            return false;
        }

        // é é¢è¼‰å…¥æ™‚
        document.addEventListener('DOMContentLoaded', () => {
            // è‡ªå‹•åµæ¸¬ä¸¦é¡¯ç¤ºå°æ‡‰å¹³å°èªªæ˜
            const platform = detectPlatform();
            showPlatform(platform);

            // æª¢æŸ¥æ˜¯å¦å·²å®‰è£
            checkInstalled();
        });

        // ç›£è½å®‰è£å®Œæˆäº‹ä»¶
        window.addEventListener('appinstalled', () => {
            console.log('å¥åº·æ•¸æ“šåŠ©ç† å·²å®‰è£');
            document.getElementById('alreadyInstalled').classList.add('show');
            document.getElementById('installBtn').classList.remove('show');
        });
    </script>
</body>
</html>
